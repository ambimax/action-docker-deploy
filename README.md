<h1 align="center">ambimax/action-docker-deploy</h1>

<p align="center">
  GitHub Action to deploy docker images.
</p>

<br>


## Introduction

GitHub Action to deploy docker images.


## Usage

Example workflow:

```yml
name: Deploy

on:
  push:
    branches:
      - master

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v1
      - uses: ambimax/action-docker-deploy@v1
        with:
          image: containous/whoami
          host: "*.preview.company.com"
          digitalocean_token: "${{ secrets.DIGITALOCEAN_TOKEN }}"
          digitalocean_cluster: "preview"
```

<!-- region:examples start -->
### [kubernetes](test/01-kubernetes)

Deploy a container to a digitalocean kubernetes cluster

```yml
      - uses: ambimax/action-docker-build@v1
        with:
          image: containous/whoami
          host: ${{ secrets.EXAMPLE_HOST }}
          digitalocean_token: ${{ secrets.EXAMPLE_DIGITALOCEAN_TOKEN }}
          digitalocean_cluster: ${{ secrets.EXAMPLE_DIGITALOCEAN_CLUSTER }}
```

### [kubernetes-custom-registry](test/02-kubernetes-custom-registry)

Deploy a container to a digitalocean kubernetes cluster

```yml
      - uses: ambimax/action-docker-build@v1
        with:
          image: ${{ secrets.EXAMPLE_DOCKER_IMAGE }}
          host: ${{ secrets.EXAMPLE_HOST }}
          port: ${{ secrets.EXAMPLE_PORT }}
          digitalocean_token: ${{ secrets.EXAMPLE_DIGITALOCEAN_TOKEN }}
          digitalocean_cluster: ${{ secrets.EXAMPLE_DIGITALOCEAN_CLUSTER }}
          docker_secret: ${{ secrets.EXAMPLE_PULL_SECRET }}
```
<!-- region:examples end -->


## Available parameters

<!-- region:parameters start -->
| Name | description | required | default |
|-|-|-|-|
| image | The image to deploy. | true |  |
| host | The host under which to deploy the image.<br><br>If the host contains "*" it will be replaced by the full deployment name.<br> | true |  |
| app | The name of the app.<br><br>If no name is given it will be set to the docker image name (without leading namespaces).<br> | false |  |
| release | The name of the release.<br><br>If no release is given it will be set to the docker image tag.<br> | false |  |
| port | The port to expose from the image. | false | 80 |
| docker_secret | The secret to use to pull images. | false |  |
| digitalocean_token | The digitalocean token, if you are deploying to digitalocean. | false |  |
| digitalocean_cluster | The name of the digitalocean_cluster if you are deploying to digitalocean. | false |  |

THIS SHOULD NOT BE HERE!
<!-- region:parameters end -->


## Development

Clone this repository

```
git clone https://github.com/ambimax/action-docker-deploy
```

Install all dependencies

```
yarn
```

Build the project

```
yarn build
```

Once done, commit the dist folder to a new feature branch and create a pull request.

**NOTE** This project makes heavy use of code generation. You really only want to edit action.yml, src/index.ts and the test folder. Sections in this readme marked with \<!-- region:xyz start -->...\<!-- region:xyz end --> are autogenerated.


## License

[MIT](LICENSE)


## Author Information

- [Tobias Faust](https://github.com/FaustTobias), [ambimaxÂ® GmbH](https://ambimax.de)
